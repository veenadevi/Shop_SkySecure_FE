<div class="compare-products-container">
    <div>
        <p-table [columns]="scrollableCols" [value]="comparisonCategories" [scrollable]="true"  frozenWidth="200px">
            <!-- <ng-template pTemplate="colgroup" let-columns>
              <colgroup>
                <col *ngFor="let col of columns" style="width:200px">
                <col style="width:200px">
                <col style="width:200px">
                <col style="width:200px">
                <col style="width:200px">
              </colgroup>
            </ng-template> -->
            <ng-template pTemplate="header" let-columns>
              <tr>
                <!-- <th *ngFor="let col of columns"> -->
                <th class="comparison-category-header">
                        
                </th>
                <ng-container *ngFor="let item of allProducts; let i = index">
                    <th *ngIf="item && item.properties && item.properties._id ; else emptyFlyer">
                        <header-card-flyer [product]="item"></header-card-flyer>
                        <div class="button-holder">
                            <div class="td-column">
                                <button class="remove-btn" (click)="removeItem(item)">
                                    Remove 
                                </button>
                                <ng-container *ngIf="item.properties.isActive">
                                <button class="buy-btn" (click)="requestQuote(item)">
                                   
                                    Buy Now
                                </button>
                                </ng-container>

                              </div>
                        </div>
                    </th>
                    <ng-template #emptyFlyer>
                        <th>
                            <empty-header-card-flyer [index] = "i" (selectedProductItem)="selectedProductItem($event)"></empty-header-card-flyer>
                            <div class="add">
                                <button class="add-btn" (click)="addProductModal(i)">
                                    Add Product
                                </button>
                            </div>
                        </th>
                    </ng-template>
                </ng-container>


                
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns">

                <tr *ngIf="(rowData.header === 'price')">
                    <td class="product-heading">
                        {{rowData.headerName}}
                    </td>
                    <td *ngFor="let item of allProducts; let i=index" class="features-align">
                        
                        <div class="product-price-detail" *ngIf="(item.properties[rowData.header] !== '-') ; else noPrice ">
                            <div  class="product-price-section" style="display:inline-flex">
                                <p class="discounted-text">
                                    - {{item.properties['priceList'].discountRate}}%
                                </p>
                                
                        <div class="price" (mouseenter)="showMonthlyPrice(i)" (mouseleave)="showDiscountRate(i)">
                            <!-- <span class="price-symbol">&#8377;  {{ isMonthly ? (item.priceList[0].price/12 | number : '1.2-2') : item.priceList[0].price }} /  {{isMonthly ? 'Monthly' : (item.priceList[0].priceType)}}</span> -->
                            <span class="price-symbol">&#8377;  {{item.properties['priceList'].price | number : '1.2-2'}} /  {{item.properties['priceList'].priceType}}</span>
                        </div>
                                    <!-- <div class="price" (mouseenter)="showMonthlyPrice()" (mouseleave)="showDiscountRate()">
                                        <span class="price-symbol">&#8377;  {{ isMonthly ? (item.properties['priceList'].price/12 | number : '1.2-2') : item.properties['priceList'].price }} </span>
                                        <span class="product-price-type"> /  {{isMonthly ? 'Month' : (item.properties['priceList'].priceType)}}</span>
                                        
                                    </div> -->
                                   
                                <p  class="gst">(GST Extra)</p>
                            </div>
                            <div style="display:inline-flex;align-items: center;">
                                <p class="mrp"> MRP:&nbsp;</p>
                                <span class="price-symbol-01">&#8377;</span>
                                <span>
                                    <p class="amount" >
                                        {{item.properties['priceList'].ERPPrice | number : '1.2-2'}}</p>
                                </span>
                            </div>
                        </div>
                        
                        <ng-template #noPrice>
                            -
                        </ng-template> 
                    </td>
                
                </tr>

                <tr *ngIf="(rowData.header === 'features')">
                        <td class="product-heading">
                            {{rowData.headerName}}
                        </td>
                        <td *ngFor="let item of allProducts" class="features-align">
                          
                           <!-- <div class="feature-item-container" *ngIf="(item.properties[rowData.header] && item.properties[rowData.header].length>0 && item.properties['includedProducts'] && item.properties['includedProducts'].length>0 ) ; else noFeaturesData"> -->
                            <div class="feature-item-container" *ngIf="((item.properties['bundleData']&&item.properties['bundleData'].length>0) ||( item.properties[rowData.header] && item.properties[rowData.header].length>0 )) ; else noFeaturesData">
                            <div class="tick-container"   *ngFor="let features of item.properties['includedProducts']">
    
                                    <div class="tick-symbol">
                                        <img src="../../../../assets/icons/ProductTickIcon.svg">
                                    </div>
                                    <span class="feature-text-left-align pointer-style " (click)="navigateToProductDetails(features)">{{features.name}}</span>
                                </div>   
                                <div class="tick-container"   *ngFor="let features of item.properties[rowData.header]">
    
                                    <div class="tick-symbol">
                                        <img src="../../../../assets/icons/BlueTickIcon.svg">
                                    </div>
                                    <span class="feature-text-left-align pointer-style" (click)="openLink(features.hyperLinkURL)">{{features.name}}</span>
                                </div>     
                                
                            </div> 
                            <ng-template #noFeaturesData>
                                -
                            </ng-template> 
                        </td>
                    
                </tr>
                <tr *ngIf="(rowData.header === 'includedProducts')">
                    <td class="product-heading">
                        {{rowData.headerName}}
                    </td>
                    <td *ngFor="let item of allProducts" class="features-align">
                        
                        <div class="feature-item-container" *ngIf="((item.properties[rowData.header]) && (item.properties[rowData.header].length>0)) ; else noBundleData">
                            <div class="tick-container"   *ngFor="let prdItem of item.properties[rowData.header]">

                                <div class="tick-symbol">
                                    <img src="../../../../assets/icons/ProductTickIcon.svg">
                                    <!-- - -->
                                </div>
                                <span class="feature-text-left-align pointer-style" (click)="navigateToProductDetails(prdItem)">{{prdItem.name}}</span>
                            </div>        
                        </div>  
                        <ng-template #noBundleData>
                            -
                        </ng-template>
                    </td>
                
                </tr>
                <!-- <ng-template #otherCat> -->
                    <tr *ngIf="(rowData.header !== 'features') && (rowData.header !== 'includedProducts') && (rowData.header !== 'price')">
                        <td  class="product-heading">
                            {{rowData.headerName}}
                        </td>
                        <td *ngFor="let item of allProducts" class="feature-text">
                            <ng-container *ngIf="(rowData.header === 'price' || rowData.header === 'entryLevelPricing') ; else otherVal">
                                <ng-container *ngIf="item && item.properties && item.properties[rowData.header] === '-' ; else presentData">
                                    -
                                </ng-container>
                                <ng-template #presentData>
                                    {{item.properties[rowData.header]}} / {{item.properties['subscription']}}
                                </ng-template>
                                
                            </ng-container>

                            
                           
                           
                            <ng-template #otherVal>
                                <span class="feature-text-align">
                                    {{item.properties[rowData.header]}}
                                </span>
                            </ng-template>
                            
                        </td>
                    </tr>
                <!-- </ng-template> -->
                
            </ng-template>
          </p-table>
    </div>
</div>

